---
title: "Vanlint Wilson 20"
date: 2020-10-30T14:25:20+09:00
draft: true
hidden: true
---

※※　注意　誤植が大量に含まれている可能性があります　※※

この章のモチベーション：原文に冗長性を持たせて、一部のデータが書き換わってしまったときに検出・訂正したい

符号には線形符号以外にも実用されているものがあるらしい：[Error correction code - Wikipedia #Types of ECC](https://en.wikipedia.org/wiki/Error_correction_code#Types_of_ECC)

参考になる文献
* [Raymond Hill (1988). A First Course In Coding](http://www.math.unipa.it/~difranco/documents/Hill.AFirstCourseInCodingTheory.pdf)

## （カンペ）線形符号の双対、生成行列、検査行列

$C$ が $q$ 元 $[n,k]$ 符号であるとする。

$C$ の基底を**行**ベクトルとして並べたものが生成行列 $G$ である。**行**ベクトル $x \in \mathbb{F}_q^k$（原文）は $xG \in \mathbb{F}_q^n$ に符号化される。

$$ C^\bot = \\{x \in \mathbb{F}_q^n \mid \forall c \in C : \langle x, c \rangle = 0 \\} $$

$C^\bot$ の基底を並べたものが検査行列 $H$。$GH^\top = O$ であり、各符号語 $c = xG \in C$ について $cH^\top = xGH^\top = 0$。

$\dim C + \dim C^\bot = n$<!--、$C^{\bot\bot} = C$--> が成立する（次元定理：$\mathrm{rank}G + \dim(\mathrm{Ker}G) = n$）。$G$ のサイズが $k \times n$ ならば $H$ は $(n-k) \times n$。

生成行列が $G = (I_k\ \ P)$（標準形）であるとき、検査行列（の一つ）は $H = (-P^\top\ \ I_{n-k})$ で構成できる。

　

---

　
<!-- 
## 問題 20G

長さ $n=2^r-1$ の $2$ 元ハミング符号の双対の weight enumerator を求め、ハミング符号自体の weight enumerator の式を導け。

（お絵描き）

後半は分かりませんでした。[ここ](http://oeis.org/wiki/List_of_weight_distributions#Hamming_codes)に並んでいます。 -->

## 例 20.4

$A$ を拡張 $[8,4]$ $2$ 元ハミング符号とする。（$[7,4]$ $2$ 元ハミング符号のそれぞれについて、元の和が $0$ となるように元を $1$ つ付け足したもの）

$A$ の生成行列を $G \in \mathbb{F}_2^{4 \times 8}$ とすると $G$ 自身が検査行列にもなるので $A = A^\bot$。また最短距離は $d=4$（$1$ は偶数個あるため）。

$t=3$ として定理 20.4 を用いる。$n-t = 5$ 以下の $0$ でない重みは $4$ のみで $1$ 通り（$\leq d-t = 1$）であるから、重みが $4$ の符号語の集合は $3$-デザインをなすことが分かる。

<!-- $$
\begin{aligned}
t &= 3 \\\\ 
v &= 8 \\\\ 
k &= 4 \\\\ 
b &= \lambda \binom v t / \binom k t = 14 \quad \therefore \lambda = 1
\end{aligned}
$$ -->

## 例 20.6

$q=17$ として得る $18 \times 18$ のパレー行列 $C$ について、生成行列 $G = (I_{18}\ \ C)$ が生成する $3$ 元 $[36,18]$ 符号を考える。

このような符号を対称符号（symmetry code）といい、この場合は $Sym_{36}$ と呼ばれる。

対称符号の一部（ここでは $Sym_{36}$）から、定理20.4 の $3$ 元符号版を使って $5$-デザインを構成できる。

> 定理 18.5

> $q$ を奇素数の冪とする。

> $$
> \begin{aligned}
> \chi(x) &= \begin{cases}
>     0 & (n=0) \\\\ 
>     1 & (n\text{ は }\mathbb{F}\_q\text{ において }0\text{ でない平方数}) \\\\ 
>     -1 & (\text{otherwise}) \\\\ 
>     \end{cases} \\\\ 
> Q &= (\chi(a_i-a_j))\_{ij}, \quad a_0,\ldots,a_{q-1}\text{ は }\mathbb{F}_q\text{ の元を列挙したもの}
> \end{aligned}
> $$

> $q \equiv 1 \pmod 4$ のとき $Q = Q^\top$（$\because \chi(-1) = 1$）、$q \equiv 3 \pmod 4$ のとき $Q = -Q^\top$（$\because \chi(-1) = -1$）。

> 前者の場合、$j$ が元がすべて $1$ の列ベクトルであるとして、

> $$
> \begin{aligned}
> C &= \begin{pmatrix}
>     0 & j^\top \\\\ 
>     j & Q \\\\ 
> \end{pmatrix} \\\\ 
> \end{aligned}
> $$

> 後者の場合、

> $$
> \begin{aligned}
> C &= \begin{pmatrix}
>     0 & j^\top \\\\ 
>     -j & Q \\\\ 
> \end{pmatrix} \\\\ 
> \end{aligned}
> $$

> とすると、$C$ は conference matrix（$CC^\top=qI$）である。この行列 $C$ を**パレー行列**という。

> ```
> + 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + + + + + + + + + + + + + + + + +
> 0 + 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + 0 + + - + - - - + + - - - + - + +
> 0 0 + 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + + 0 + + - + - - - + + - - - + - +
> 0 0 0 + 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + + + 0 + + - + - - - + + - - - + -
> 0 0 0 0 + 0 0 0 0 0 0 0 0 0 0 0 0 0 + - + + 0 + + - + - - - + + - - - +
> 0 0 0 0 0 + 0 0 0 0 0 0 0 0 0 0 0 0 + + - + + 0 + + - + - - - + + - - -
> 0 0 0 0 0 0 + 0 0 0 0 0 0 0 0 0 0 0 + - + - + + 0 + + - + - - - + + - -
> 0 0 0 0 0 0 0 + 0 0 0 0 0 0 0 0 0 0 + - - + - + + 0 + + - + - - - + + -
> 0 0 0 0 0 0 0 0 + 0 0 0 0 0 0 0 0 0 + - - - + - + + 0 + + - + - - - + +
> 0 0 0 0 0 0 0 0 0 + 0 0 0 0 0 0 0 0 + + - - - + - + + 0 + + - + - - - +
> 0 0 0 0 0 0 0 0 0 0 + 0 0 0 0 0 0 0 + + + - - - + - + + 0 + + - + - - -
> 0 0 0 0 0 0 0 0 0 0 0 + 0 0 0 0 0 0 + - + + - - - + - + + 0 + + - + - -
> 0 0 0 0 0 0 0 0 0 0 0 0 + 0 0 0 0 0 + - - + + - - - + - + + 0 + + - + -
> 0 0 0 0 0 0 0 0 0 0 0 0 0 + 0 0 0 0 + - - - + + - - - + - + + 0 + + - +
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + 0 0 0 + + - - - + + - - - + - + + 0 + + -
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + 0 0 + - + - - - + + - - - + - + + 0 + +
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + 0 + + - + - - - + + - - - + - + + 0 +
> 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + + + + - + - - - + + - - - + - + + 0
> ```


符号語の重みとしてありうる値を調べる

#### $Sym_{36}$ は自己双対

（証明）$$ GG^\top = (I_{18} \ \ C) \begin{pmatrix} I_{18} \\\\ C \end{pmatrix} = I_{18} + 17I_{18} = . $$
よって $G$ は $Sym_{36}$ の検査行列でもあり、行ベクトルが張る空間も一致する。

#### 各符号語の重みは $3$ の倍数

（証明）$GG^\top = O$ より各符号語の自身との内積は $0$。（$3$ 元符号なので符号語の各元は $\mathbb{F}_3$ の元であることに注意）

#### $\boldsymbol{a},\boldsymbol{b} \in \mathbb{F}\_3^{18}$ について $(\boldsymbol{a}\ \ \boldsymbol{b}) \in Sym_{36}$ のとき $(-\boldsymbol{b}\ \ \boldsymbol{a}) \in Sym_{36}$

（証明）$G = (I_{18}\ \ C)$ より $(-C\ \ I_{18})$ も検査行列（の一つ）である（$C^\top=C$ に注意）。$Sym_{36}$ は自己双対なので、$(-C\ \ I_{18})$ も $Sym_{36}$ の生成行列。

#### 符号語の重みは $12$ 以上

（証明）ある符号（$(\boldsymbol{a} \ \ \boldsymbol{b})$ とおく）について重みが $12$ 未満であると仮定する。

鳩ノ巣原理より $\boldsymbol{a},\boldsymbol{b}$ のどちらかの重みは $5$ 以下。先ほどの主張を使い、一般性を失わず $\boldsymbol{a}$ の重みが $5$ 以下と仮定する。

$G = (I_{18}\ \ C)$ の左 $18$ 列は単位行列なので、この符号は $G$ の $5$ 個以下の行ベクトルの線形結合であることがわかる。

あとは重みが $12$ 未満であって $G$ の高々 $5$ 個の行ベクトルの線形結合であるような符号が存在しないことを示せばよいです。スクリプトを書いて全探索で確かめる以外の方法はわからず…

### 定理20.4 の $q$ 元符号版（オリジナル Assmus-Mattson Theorem）

E.F Assmus, H.F Mattson *New 5-designs* J. Combinatorial Theory, 6 (1969), pp. 122-151 [URL](https://www.sciencedirect.com/science/article/pii/S0021980069801158)

$A$ を $\mathbb{F}_q$ 上の $[n,k,d]$ 符号とし、その双対 $B = A^\bot$ を $[n, n-k, e]$ 符号とする。

$v_0,w_0$ をそれぞれ次の条件を満たす $n$ 以下で最大の整数とする。
$$
\begin{aligned}
v_0 - \left\lfloor \frac{v_0 + (q-2)}{q - 1} \right\rfloor &< d \\\\ 
w_0 - \left\lfloor \frac{w_0 + (q-2)}{q - 1} \right\rfloor &< e
\end{aligned}
$$

$t < d$ について、$B$ の符号の非零の重みであって $n-t$ 以下であるものの個数は $d-t$ 以下であるとする。

このとき、任意の $v \leq v_0$ について、重みが $v$ である $A$ の符号語は $t$-デザインをなす。

また、任意の $w \leq \min(n-t,w_0)$ について、重みが $w$ である $B$ の符号語は $t$-デザインをなす。

　

証明は上に引用した文献の定理4.2 を見てください。重みが $v_0$ を上回る符号語は、非零成分の位置が同じものでも片方がもう片方のスカラー倍**でない**ことがある。あとは定理20.4 とそんなに変わらない。

重み $24$ で片方がもう片方のスカラー倍でない例：
```
0 0 0 0 0 0 0 0 0 + + - 0 - - + - -  + 0 - + + 0 + - - - + - - - + - - +
0 0 0 0 0 0 0 0 0 + - - 0 + - + + +  - 0 + + - 0 - - - - + + - + + + + +
```
重み $21$ で片方がもう片方のスカラー倍である例：
```
0 0 0 0 0 0 0 0 0 0 0 0 0 - + - + +  + - - + - - - - 0 - + + + 0 + - - +
0 0 0 0 0 0 0 0 0 0 0 0 0 + - + - -  - + + - + + + + 0 + - - - 0 - + + -
```
そもそも非零成分の位置が同じ符号の組はそんなに多くない：
```
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + +  - - 0 0 0 + + 0 - 0 + + 0 0 0 - + +
0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 + -  0 0 + - + 0 0 - 0 + 0 0 - + - 0 - +
```

　

$Sym_{36}$（$3$ 元 $[36, 18, 18]$ 符号）は自己双対であり、$w_0 - \left\lfloor (w_0 + 1) / 2 \right\rfloor < d=12$ を満たす最大の整数は $w_0 = 23$。

$t=5$ とする。非零の重みであって $n-t=31$ 以下のものは $12, 15, \ldots, 30$ で $7$ 個であり、$d-t = 7$ 以下である。よって各 $w=12, 15, 18, 21$ について、重みが $w$ である符号語は $5$-デザインをなす。$1$-、$2$-、$3$-、$4$-デザインも同様。

## ゴレイ符号

$11 \times 11$ の $(0,1)$-行列 $N$ を $2$-$(11,6,3)$ 対称デザインの結合行列であるとする。（$b=v$）

$j \in \mathbb{F}_2^{11}$ が元がすべて $1$ の列ベクトルであるとして、次のようにおく。

$$ 
\begin{aligned}
P &= \begin{pmatrix}
    0 & 1 & \cdots & 1 \\\\ 
    1 & \ &    \   & \ \\\\ 
\vdots& \ &    N   & \ \\\\ 
    1 & \ &    \   & \ 
\end{pmatrix} \\\\ 
G &= \begin{pmatrix} I_{12} & P \end{pmatrix}
\end{aligned}
$$

$G$ が生成する $[24,12]$ 符号を $G_{24}$、$G$ から任意の $1$ 列を削除した行列が生成する $[23,12]$ 符号を $G_{23}$ とおく。

このとき $G\_{23}$ は $3$-誤り訂正**完全符号**である（どの $x \in \mathbb{F}\_2^{23}$ についても、$x$ からの距離が $3$ 以下の符号語がただ一つ存在する）。これを**ゴレイ符号**という。$G\_{24}$ は拡張ゴレイ符号。

> 蛇足

> ゴレイ符号は $2$ 元版と $3$ 元版があり、ここでは前者のみを扱う。

> ボイジャー１号・２号が木星や土星のカラー写真を送信するために $G_{24}$ が使われた（アダマール符号からの移行）。

> (van Lint and Tietäväinen) A non-trivial perfect $q$-ary code, where $q$ is a prime power, must have the same parameters as one of the Hamming or Golay codes. [Hamming bound - Wikipedia #Perfect Codes](https://en.wikipedia.org/wiki/Hamming_bound#Perfect_codes), [Raymond Hill (1988). A First Course In Coding Theory Theorem 9.5](http://www.math.unipa.it/~difranco/documents/Hill.AFirstCourseInCodingTheory.pdf)

> パラメータはハミング符号と同じだが線形符号でない例なども構成されているらしい　参考：[A First Course In Coding Theory](http://www.math.unipa.it/~difranco/documents/Hill.AFirstCourseInCodingTheory.pdf)

　

> 思い出すシリーズ

> 対称デザイン：$b=v$ であるような $2$-デザイン

> 問題19D
>
> 11次の01行列であって
>
> * 各行に1が6個
> * 任意の異なる2行の内積はたかだか3
>
> を満たすようなものは、2-(11,6,3)の結合行列であり、同型を除いて一意であることを示せ

> （これの補デザインは $12$ 次のアダマール $2$-デザインであり、$12$ 次のアダマール行列から $1$ 通りに作れる）
> ```
> N =
>  1 0 1 0 0 0 1 1 1 0 1
>  1 1 0 1 0 0 0 1 1 1 0
>  0 1 1 0 1 0 0 0 1 1 1
>  1 0 1 1 0 1 0 0 0 1 1
>  1 1 0 1 1 0 1 0 0 0 1
>  1 1 1 0 1 1 0 1 0 0 0
>  0 1 1 1 0 1 1 0 1 0 0
>  0 0 1 1 1 0 1 1 0 1 0
>  0 0 0 1 1 1 0 1 1 0 1
>  1 0 0 0 1 1 1 0 1 1 0
>  0 1 0 0 0 1 1 1 0 1 1
> ```

ここからはゴレイ符号が $7$-誤り訂正完全符号であることを示す。

#### $\boldsymbol{x} N=0$ を満たす $\boldsymbol{x} \neq 0$ は $(1,1,\ldots,1)$ のみ

> 式(19.3)
>
> $2$-デザインにおいて、反復数を $r$（$1$ つの点に結合するブロックの個数、$b_1$ の別名）とすると
> $$ bk = vr $$
> この場合は $b=v$ なので $k=r$

> 式(19.7)
>
> $2$-デザインの結合行列 $N$ について
> $$ NN^\top = (r-\lambda)I + \lambda J $$

各成分を $\mathbb{F}_2$ で考えると、$NN^\top = I+J$ であり $\mathrm{rank}(NN^\top) = 10$、よって $\mathrm{rank}N = 10$。

（メモ：一般に行列 $A,B$ について $\mathrm{rank}(AB) \leq \mathrm{rank}A$であるが、$\mathrm{rank}N = 11$（正則）ならば $\mathrm{rank}(NN^\top) = 11$）。

<!-- #### $N$ の行ベクトル・それら $2$ つの和は重みが $6$ に等しい

前者は $b_1$ なので、$b_1 = r = 6$

後者は $2b_1 - 2b_2$（ベクトルの成分が $\mathbb{F}_2$ の元であることに注意）であるが、
$$ b_2 = \lambda \binom{v-2}{t-2} / \binom{k-2}{t-2} = 3 \binom{9}{0} / \binom{4}{0} = 3 $$
より $2 \cdot 6 - 2\cdot 3 = 6$。 -->

#### $G_{24}$ の符号語の重みは $4$ の倍数

> 重み $w(x) = d(x,0)$

$S_i$ を $G$ の相異なる $i$ 個の行ベクトルの和の集合とする。任意の $a, b \in S_1$ について、
$$ \begin{aligned}
w(a) &= b_1 + 2 = 8 \\\\ 
w(ab) &= \begin{cases}
    b_1 + 2 = 8  & (a = b) \\\\ 
    b_2 + 1 = 4 & (a \neq b)
    \end{cases} \\\\ 
    &\quad (\text{ただし積は成分ごとにとる})
\end{aligned} $$ より
$$
\begin{aligned}
w(a) &\equiv 0 \pmod 4 \\\\ 
w(ab) &\equiv 0 \pmod 2
\end{aligned}
$$

任意の $a \in S_i, b \in S_1$ について上の条件が成り立つとき、任意の $c \in S_1$ について

$$ \begin{aligned}
w(a+b) &= w(a) + w(b) - 2w(ab) \\\\ 
       &\equiv 0 \pmod 4 \\\\ 
w((a+b)c) &= w(ac) + w(bc) - 2w(abc) \\\\ 
          &\equiv 0 \pmod 2
\end{aligned} $$

よって $i+1$ の場合についても条件が成り立つ。帰納法より、任意の $i \geq 1$、任意の $a \in S_i$ について $w(a) \equiv 0 \pmod 4$ が示された。$i=0$ の場合も自明。

#### $G_{24}$ の $0$ でない符号語の重みは $8$ 以上

$i = 1,2$ については、$a \in S_1$、$s \in S_2$ とおくと $w(a) = 8$、$w(s) = 8 + 8 - 2 \cdot 4 = 8$ よりよい。

$i = 3,4$ については、先ほどの補題から $N$ の $3$ つ（$4$ つ）の行の線形結合が $0$ でないことが分かっているので、$a \in S_3$（$S_4$）について $w(a) > 4$（$\because$ お絵描き）。$4$ より大きい $4$ の倍数は $8$ 以上。

$i > 4$ についても $w(a) > 4$（お絵描き）

#### $G_{23}$ は最小距離 $7$ の完全符号

上の補題より $G_{24}$ の最小距離は $8$ 以上、$G_{23}$ は $7$ 以上。

> 定理20.1
>
> 符号 $C \subset S^n(=[q]^n)$ の最小距離 $d$ について $2e+1 \leq d$ であるような $e$ をとると、
> $$ |C| \cdot \sum_{i=0}^e \binom{n}{i} (q-1)^i \leq q^n $$
> 等号が成立するとき $C$ は $e$-誤り訂正完全符号である。（このときの $e$ の値を腓腹半径と呼ぶ）

> $C$ が $q$ 元 $[n,k]$ 符号であるとき、$|C| = q^k$

> 生成行列 $G$ のサイズは $12 \times 24$ なので $G_{24}$ は $[24,12]$ 符号、$G_{23}$ は $[23,12]$ 符号

$e = 3$ とおくと、$G_{23}$ について $q=2$、$2e+1 = 7 \leq d$、$n = 23$、$k = 12$ より

$$ \begin{aligned}
& 2^{12} \cdot \sum_{i=0}^3 \binom{23}{i} (2-1)^i \\\\ 
    &= 2^{12} \cdot \left(1 + 23 + 253 + 1771\right) \\\\ 
    &= 2^{12} \cdot 2^{11} \\\\ 
    &= 2^{23}
\end{aligned}$$

等号が成立するので、$G_{23}$ は最小距離 $7$ の完全符号である。

（メモ：ここまでの議論は、$e=3$ とおいても大丈夫（左辺において重複がない）ことを確認するためのものだった）

　

## 定理20.5

符号 $C$ が長さ $24$、最小距離 $8$、$|C|=2^{12}$、$0 \in C$ であるとき、$C$ が $G_{24}$ と同値である。

#### 証明 (i)（$C$ が線形符号）

途中 maspy さんに助けていただきました。ありがとうございます。

$C$ の各符号語から任意の座標を $1$ つ削除した符号を $C'$ とする。$C'$ は長さ $23$、最小距離 $7$ 以上、$|C'| = 2^{12}$、$0 \in C'$。

> 問題20E

> $C$ が必ずしも線形でない $2$ 元符号であって、長さ $23$、最小距離 $7$、$|C| = 2^{12}$、$0 \in C$ であるとする。

> 1. $C$ が完全符号であることを示せ。
> 2. $A_7 = 253$ を示せ。
> 3. $A_i$ の値がすべて一意に定まることを示せ。

> 　

> （1.）定理20.1

> （2.）$c \in C$、$w(x) = 4$、$d(x, c) \leq 3$ を満たす $(x, c)$ をダブルカウントする。$d(c,0) \geq 7$ より $A_1,\ldots,A_6 = 0$ であることに注意。

> 最小距離が $7$ なので $d(c, 0) \geq 7$、よって $w(c) = 7$、また $c$ は $x$ を「被覆」する。各 $c$ に対してそのような $x$ は $\binom{7}{4}$ 個存在する。

> 1.より、$w(x)=4$ を満たす任意の $x \in \mathbb{F}_2^{23}$ について $d(x,c) \leq 3$ を満たす符号語 $c$ がただ $1$ つ存在すので、ダブルカウントにより $$ \binom{23}{4} = A_7\binom{7}{4} $$

> よって $A = 8855/35 = 253$。

> （3.）$c \in C$、$w(x) = 5$、$d(x, c) \leq 3$ を満たす $(x,c)$ をダブルカウントする。$\binom{23}{5} = A_7 \binom{7}{5} + A_8 \binom{8}{5}$ より $A_8 = 506$。

> $w(x) = 6$ とすると $\binom{23}{6} = A_7 (\binom{7}{6}+\binom{7}{5}(23-7)) + A_8 \binom{8}{6} + A_9 \binom{9}{6}$ より $A_9 = 0$。（$w(c) = 7$ を満たす $c$ は、$x$ を必ずしも被覆しないことに注意：$w(cx)=5$ の場合）

> 以下同様

$C$ の各符号語から任意の座標を $1$ つ削除した符号を $C'$ とする。$C'$ は長さ $23$、最小距離 $7$ 以上、$|C'| = 2^{12}$、$0 \in C'$。

問題20E より、$C'$ は被服半径 $3$ の完全符号であり、$A_0=A_{23}=1$、$A_7=A_{16}=253$、$A_8=A_{15}=506$、$A_{11}=A_{12}=1288$、あとは $0$ であることが分かる。

「$C$ からどの座標を消しても」符号 $C'$ の重みが $0,7,8,11,12,15,16,23$ ということは、$C$ の符号語の重みは $0,8,12,16,24$。

（長さ $24$、最小距離 $8$、$|C|=2^{12}$、$0 \in C$ を満たす）どのような $C$ についても重みが $0,8,12,16,24$ であり、任意の座標ですべての符号語の $0$ と $1$ を入れ換えても $C$ の条件や符号語同士の距離は不変。任意の $c \in C$ について、$c$ が原点になるように $C$ を操作すると操作先での重みが  $0,8,\ldots,24$ であることから、$c$ と他の符号語の距離も $0,8,\ldots,24$ である。（すごい）

任意の $c_1,c_2 \in C$ について $w(c_1),w(c_2),d(c_1,c_2)(=w(c_1)+w(c_2)-2w(c_1c_2))$ が $4$ の倍数であることから、$w(c_1c_2)$ は $2$ の倍数、$\langle c_1,c_2 \rangle = 0$ がわかる。

$C$ の符号語が張る、長さ $24$ の $2$ 元線形符号 $V$ を考える。先ほどの結果よりこれは自己双対であるが、$\dim V + \dim V^\bot = 24$ より $k=12$、$|V| = 2^{12}$ となり、$V$ は $C$ と一致する。よって $C$ は自己双対の線形符号。

#### 証明 (ii)

$C$ の基底の一つに重みが $12$ であるものをとり、生成行列 $G \in \mathbb{F}_2^{12 \times 24}$ を次のような形にとる。

$$ G = \begin{pmatrix}
 1 & \cdots & 1 & 0 & \cdots & 0 \\\\ 
 \ &    A   & \ & \ &    B   & \ 
\end{pmatrix} $$

このとき、$B$ の $1$ 個以上の行ベクトルの和の重みは、$0$ でない偶数である。

（証明）非零の行ベクトル $a$ について $w(aA) = s$、$w(aB) = t$ とおく。符号語 $(0 \ \ a) G$ の重みは $s + t$、符号語 $(1 \ \ a) G$ の重みは $12 - s + t$ となる。

これらがともに $4$ の倍数（$0,8,12,16,24$）であるから、$t$ は偶数。また、$t=0$ とすると $s = 0,12$ となり、いずれも $G$ の行ベクトルが線形独立であることに矛盾。

これより $B$ の行は線形独立である。$B$ が生成行列として生成する符号は $[12,11]$ 符号であり、任意の符号語の重みは偶数。これより、$B$ を階段行列に簡約すると、

$$ \begin{pmatrix}
    1 & \ & O & 1 \\\\ 
    \ & \ddots & \ & \vdots \\\\ 
    O & \ & 1 & 1
\end{pmatrix} $$

という形になる。

ここで $G$ の列を入れ替えて（すなわち $C$ の座標の順番を入れ替えて）簡約すると、次のような形にできる。

$$ \begin{aligned}
    G &= (I_{12} \ \ P) \\\\ 
    P &= \begin{pmatrix}
        0 & 1 & \cdots & 1 \\\\ 
        1 & \ &    \   & \ \\\\ 
    \vdots& \ &    N   & \ \\\\ 
        1 & \ &    \   & \ 
    \end{pmatrix}
\end{aligned} $$

あとは $N$ が $2$-$(11,6,3)$ デザインの結合行列であることを言えれば勝ち。

> 問題19D

> 11次の01行列であって
>
> * 各行に1が6個
> * 任意の異なる2行の内積はたかだか3
>
> を満たすようなものは、2-(11,6,3)の結合行列であり、同型（結合行列の行・列の並び替え）を除いて一意であることを示せ

$N$ の各行の重みは $6$（符号語の重みが $0,8,12,\ldots$ なので、$N$ の各行の重みは $6,10$ に限られる。後者の場合は $G$ の一行目を加えると符号語の重みが $4$ になってしまう）

また、$N$ の $2$ 行の和は $6$ または $10$ なので、内積は $3$ または $1$。

よって問題19Dの結果から $N$ は $2$-$(11,6,3)$ の結合行列である。これより $C$ は $G_{24}$ と同値である。

## 例20.5

定理20.4 を $G_{24}$ に適用する。$G_{24}$ は自己双対の $[24,12,8]$ 符号で重みは $0,8,12,16,24$ がある。

$t=5$ とおくと $n-t = 24-5 = 19$ 以下の非零の重みは $d-t = 3$ 個以下なので、（例えば）重みが $8$ の符号語の台は $5$-デザインをなす。これを $\mathcal{D} = (\mathcal{P}, \mathcal{B})$ とする。

重みが $8$ の符号語は $759$ 個あるので、$b = \lambda \binom v t / \binom k t$ から $\lambda = 1$。よって $\mathcal{D}$ は $S(5, 8, 24)$。$S(5,8,24)$ は Witt デザインと呼ばれる。

> This system ($S(5, 8, 24)$) is connected with many of the sporadic simple groups and with the exceptional 24-dimensional lattice known as the Leech lattice.

> [Steiner system - Wikipedia #The Steiner System S(5, 8, 24)](https://en.wikipedia.org/wiki/Steiner_system#The_Steiner_system_S(5,_8,_24))

$G\_{24}$ の成分の並び替えや $S(5, 8, 24)$ のブロックのラベル貼り換えは自己同形写像であり、この群は **Mathieu群** $M\_{24}$ と呼ばれる。

　

$3$ 元部分集合 $I \subset \mathcal{P}$ をとる。誘導デザイン $\mathcal{D}_I$ は $S(2,5,21)$ である。$S(2,5,21)$ はすべて $PG_2(4)$ と同型であることが知られている。

> $PG_2(q)$ ：位数 $q$ の射影平面

> $PG_2(q)$ の点、直線：それぞれ線形空間 $\mathbb{F}_q^3$ の $1,2$ 次元部分空間

> 点集合が $\mathcal{P}$、ブロック集合が $\mathcal{B}$ の Steiner system $S_\lambda(t,k,v)$、 $\mathcal{D}$ に対し、$|I| = i \leq t$ であるような $I⊂P$ をとる。
> 点集合を $P \setminus I$、ブロック集合を $\\{B \setminus I \mid I⊂B \\}$ とするデザインを考えると、これは $S_\lambda(t-i,k-i,v-i)$ をなす。これを、$\mathcal D$ の誘導デザインといい、$\mathcal D_I$ と表す。

## 問題20H

$B \in \mathcal B$、$I \subset \mathcal P$ をとり、$\alpha = |B \cap I|$、$B^* = B \setminus I$ とする。$\alpha = 3$ であるとき、$B^*$ が $PG_2(4)$ の直線であることは確認した。次を示せ。
1. $\alpha = 2$ ならば $B^*$ は $PG_2(4)$ における超卵形である
2. $\alpha = 0$ ならば $B^*$ は $PG_2(4)$ における $2$ 直線の対称差である

おまけ：$\alpha = 1$ ならば、$B^\*$ の $7$ 点と、そのうち $2$ 点以上を含む $PG_2(4)$ の直線の集合が Fano plane（$PG_2(2)$）をなすことを示せ。これは $PG_2(4)$ の Baer subplane と呼ばれる。

> 偶数オーダーの射影平面上の超卵形：どの $3$ つも同一直線上にないような $q+2$ 個の点の集合のこと。問題19Iにちらっと登場

　

$I$ は $B$ の部分集合であるとしてよい。$B^*$ は誘導デザイン $\mathcal D_I$ のブロックであるから、$\alpha = |I| = 3$ のときこれは $PG_2(4)$ のブロック（直線）である。

１．（「$B^*$ が $PG_2(4)$ に含まれる」というのが言い方としてしっくり来ていません　「適当な誘導デザインをとると～」と脳内で補完しています）

重みが $8$ であるような相異なる符号語 $a,b \in G_{24}$ について、$w(a+b) = 8,12,16,\ldots$ より $w(ab) = 0, 2, 4$。これらのブロックから $|I|=2$ であるような $I$ の元を取り除いたとき、$\mathcal D_I$ の相異なる $2$ つのブロックの共通部分の位数は高々 $2$。よってあるブロックに属する $3$ つ以上の点が他の同じブロックに属することはない。

２．「任意の $B \in \mathcal B$ について、$B_1 \oplus B_2 = B$ であるような $B_1,B_2 \in \mathcal B$ が存在する」と言えればよい。

$B$ に対応する符号語 $c \in G_{24}$ を考える。$w(c_1)=8$ かつ $w(cc_1) = 4$ であるような $c_1$ をとる（注）。$c_2 = c + c_1$ として対応する $B_1,B_2$ を得る。

（注）適当に座標を並び替える（すなわち点のラベルを貼り換える）ことにより、$c$ を[#ゴレイ符号](#ゴレイ符号)で示したような $G_{24}$ の生成行列 $G$ の $2$ 行目であるとしてよい。このとき $G$ の右下の結合行列 $N$ がなす $2$-$(11,6,3)$ デザインにおいて $b_2=3$ であったことから、$G$ の $3$ 行目などを選んで $c_1$ とすればよい。

おまけ．~~わかりましたが資料が間に合っていないのでお絵描きです~~ わかっていませんでした

<!-- ３．ふたたび $B$ に対応する符号語 $c$ をとる。$w(cc_1) \geq 3$ であるような $c_1$ について考える（Fano plane の直線になるはずのもの）。$w(cc_1) = 4$ となる（１．参照）。

デザイン $\mathcal D$ において、$b_4 = \lambda \binom{v-4}{t-4} / \binom{k-4}{t-4} = \binom{20}{1} / \binom{4}{1} = 5$
 -->

<!-- ## 問題20I

$\mathbb{F}_4 = \\{0, 1, \omega, \omega^2\\}$ とおく。$[6,3]$ 符号 $C$ を次のようにとる。

$$ C = \\{(a, b, c, f(1), f(\omega), f(\omega^2)) \mid a,b,c \in \mathbb{F}_4,\ f(x) := ax^2+bx+c \\} $$

1. $C$ の最小重みが $4$ であり、重み $5$ の符号語が存在しないことを示せ。
2. 次の条件を満たす $4\times6$ の $\mathbb{F}_2$-行列 $A$ を符号語とみなし、そのような $A$ 全体の集合を $2$ 元符号 $G$ とする。
  * $A = (a_0, a_1, a_\omega, a_{\omega^2})^\top$ とするとき、$a_0,\ldots,a_{\omega^2}$ の成分の和がすべて等しく、$a_1 + \omega a_\omega + \omega^2 a_{\omega^2} \in C$  
  $G$ が $[24,12,8]$ 符号である、すなわち $G_{24}$ と同値であることを示せ。

　

$C$ の生成行列は次のように表せる。

$$ \begin{pmatrix}
    1 & 0 & 0 & 1 & \omega^2 & \omega \\\\ 
    0 & 1 & 0 & 1 & \omega & \omega^2 \\\\ 
    0 & 0 & 1 & 1 & 1 & 1
\end{pmatrix} $$

検査行列は、

$$ \begin{pmatrix}
    1 & 1 & 1 & 1 & 0 & 0 \\\\ 
    \omega^2 & \omega & 1 & 0 & 1 & 0 \\\\ 
    \omega & \omega^2 & 1 & 0 & 0 & 1
\end{pmatrix} $$

２．$G$ が線形符号であることは明らか。 -->

　

今度はデザインが生成する符号を考える。

$N$ を オーダー $n$ の射影平面の結合行列（正方行列）であるとし、$N$ が生成する $2$ 元符号を $C$ とする。

#### $n$ が奇数の場合

直線（ブロック）の位数は $k = n+1$ で偶数、また任意の $2$ つの直線は $1$ 点で交わるので、任意の 直線 $B$ について、$B$ と結合する行を足すと $B$ の位置の成分が $0$ であとは $1$ のベクトルが得られる。$N$ の行をすべて足すと $0$ になるので $\dim C < v$ であり、よって $\dim C = v-1$。符号語の重みは偶数なので $[v, v-1, 2]$ 符号。

　

位数 $n=10$ の射影平面が存在しないことを示したい。そのようなデザインが存在すると仮定した場合に結合行列 $N$ が生成する符号の幾何的な特徴を調べ、そのようなものが存在しないことを言いたい。（最終的にはコンピュータによる探索）

## 定理20.6

$n \equiv 2 \pmod 4$ であるとき、オーダー $N$ の射影平面の結合行列 $N$ の行ベクトルが生成する $2$ 元符号 $C$ について、$\dim C = (n^2+n+2)/2$。

#### 証明

（上からの評価）

$N$ の各行の重みは奇数、$2$ 行の成分ごとの積の重みは $1$（$2$ 点を通る直線）。

よって、$C$ の拡張符号 $\overline{C}$（長さ $v+1=n^2+n+2$）は自己直交であり、$(\dim C =)\ \dim \overline{C} \leq (n^2+n+2)/2$。

（下からの評価）

$\dim C = r$、$\dim C^\bot = s$ とおく（$r+s=v=n^2+n+1$）。検査行列 $H$ を階段行列の形にとって適当に符号語の成分を並び替え、$H = (I_s \ \ P)$ とおく。ここで、

$$ A = \begin{pmatrix}
    I_s & P \\\\ 
    O   & I_r
\end{pmatrix} $$

とおくと、$\det A = 1$ なので、（$N,A$ を $\mathbb{Z}$ 行列とみなすとき）

$$ \det NA^\top = \det N = (n+1)n^{(n^2+n)/2} $$

> 定理19.7周辺

> 対称デザインについて $NN^\top = (k-\lambda)I+\lambda J$ より $(\det N)^2 = \det NN^\top = k^2(k-\lambda)^{v-1}$

$NA^\top$ は整数行列で左 $s$ 列は $\bmod 2$ で $0$ なので、$\det NA^\top$ は $2^s$ で割り切れる。

$n \equiv 2 \pmod 4$ より $(n^2+n)/2 \geq s = n^2+n+1-r$、すなわち $\dim C = r \geq (n^2+n+2)/2$。

　

この結果から $\overline{C}$ が自己双対であることが分かる。以下、符号語を射影平面における点の集合と同一視する。

## 定理20.7

引き続き $n \equiv 2 \pmod 4$ とする。

$C$ の最小距離は $n+1$ であり、重み $n+1$ の符号語の集合は $N^\top$ が表す射影平面の直線集合と一致する。

#### 証明

※定理19.9より、$N^\top$ も $N$ と同様に位数 $n$ の射影平面の結合行列となる。$N^\top$ が表す射影平面を考えるとき、直線は $N$ の行ベクトルに対応する。

（前半）

任意の符号語 $c \in C \setminus \\{0\\}$ をとり $d = w(c)$ とおく。$2$ 元符号 $\overline{C}$ が自己双対であるから、

1. $d$ が奇数ならば $c$ は任意の（射影平面の）直線と奇数個（ゆえに $1$ 個以上）の共有点を持つ
2. $d$ が偶数ならば $c$ 上の任意の点 $x$ について $x$ を通る任意の直線が $c$ と $x$ 以外の共有点を持つ

１．の場合、射影平面において各点を $n+1$ 本の直線が通るので、共有点ごとに直線を数えて $(n+1)d \geq b = n^2+n+1$。よって $d \geq n+1$。

２．の場合、$x$ を通る直線が $n+1$ 本あり、共有点は重複しないので、$d \geq (n+1)+1$。

$N$ の各行は重みが $n+1$ なので、$d$ は最小値 $n+1$ をとる。

（符号語から直線への単射）

$d = n+1$ であるような $c$ について、$c$ 中の $3$ 点以上を通る直線 $L$ をとる（これは上の１．より存在する）。$c$ が $L$ と一致することを示す。位数はよい。$L$ 上にあって $c$ に属さない点 $x$ が存在すると仮定すると、$x$ を通る $L$ 以外の $n$ 個の直線が $c$ との相異なる共有点を持ち、$L$ の $c$ との共有点と合わせて $n+3 \leq d$ となって仮定に矛盾。

（重み $n+1$ の符号語の個数 $\geq$ 直線の本数）

$N$ 中の $v\ (=b)$ 個の行ベクトルの重みは $n+1$。

## 定理20.8

$C$ の重み $n+2$ の符号語全体の集合は射影平面の超卵形全体の集合に一致する。

#### 証明

（符号語 $\Longrightarrow$ 超卵形）

重み $n+2$ の $c \in C$ を任意にとる。

$\overline{C}$ が自己双対であることから、$c$ と射影平面の任意の直線は偶数個の共有点を持つ。

任意に直線 $L$ をとり、$c$ と $L$ の共有点が $2a$ 個あるとする。このうち $1$ 点を任意にとって $x$ とおく。定理20.7の証明中１．より、$x$ を通る $L$ 以外の $n$ 個の直線が $c$ との相異なる共有点を持ち、合わせて $n+2a \leq n+2$ より $a = 0, 1$。これは $c$ が超卵形であることを示している。

（超卵形 $\Longrightarrow$ 符号語）

超卵形 $V$ と点 $p \not\in V$ を任意にとる。任意の $v \in V$ について直線 $pv$ が存在し、この直線と $V$ との共有点は先の結果からちょうど $2$ 個。$|V| = n+2$（超卵形の定義）より、$p$ を通る $V$ の割線（$V$ の $2$ 点を通る直線）は $(n+2)/2$ 本。$p \in V$ の場合は、$p$ を通る任意の直線は $V$ の割線なので $n+1$ 本。

各割線は定理20.7より $C$ の符号語である。$V$ のそれぞれの割線について対応する符号語の和をとると、$n \equiv 2 \pmod 4$ よりこれは $V$ に一致する。

　

位数 $10$ の射影平面は存在しない：[Lam, C., Thiel, L., & Swiercz, S. (1989). _The Non-Existence of Finite Projective Planes of Order 10. Canadian Journal of Mathematics, 41_(6), 1117-1123. doi:10.4153/CJM-1989-049-4](https://www.cambridge.org/core/services/aop-cambridge-core/content/view/EBD5E851090B1983978BBC6FE18D2A3F/S0008414X00002534a.pdf/div-class-title-the-non-existence-of-finite-projective-planes-of-order-10-div.pdf)

## 問題20K

次の条件を満たす、$4 \times 39$ の $\mathbb{F}_3$ 行列を求めよ。
1. どの列も $0$ ベクトルでなく、他の列のスカラー倍でない
2. どの行も $0, 1, -1$ を $13$ 個ずつ含む。
一般化して、同様の条件を満たす $r \times \frac12(3^r-1)-1$ の $\mathbb{F}_3$ 行列を求めよ。

　

「どの列も成分が $2$ 種類以上ある」という条件を付け、帰納的に構成する。

r = 1  
1 x 0
```
```

r = 2  
2 x 3
```
012
120
```

r = 3  
3 x 12
```
012 012 012 012
120 120 120 012
000 111 222 120
```

r = 4  
4 x 39
```
012012012012 012012012012 012012012012 012
120120120012 120120120012 120120120012 012
000111222120 000111222120 000111222120 012
000000000000 111111111111 222222222222 120
```

> 39枚のコインがあります。この中でちょうど１枚が偽物で、他と重さが違います。重いか軽いかは分かりません。

> 何枚かのコインの重さを比較できる２皿のてんびんを使い、４回以内の比較で偽物を特定して重いか軽いかを答えてください。

（重いか軽いかを検出しないなら $40$ 枚から偽物を特定できる）

## 問題20L

わかりませんでした…
